{% extends "base.html" %}

{% block title %}Music Search{% endblock %}

{% block content %}
  <h1>Discover Music</h1>

  {% if user.is_authenticated %}
    <form method="get" action="{% url 'music' %}">
      <input type="text" name="q" placeholder="Search">
      <button type="submit">Search</button>
    </form>

    <ul>
      {% for key, value in response.items %}
        <li>
          <a href="{{ value.url }}"><img src="{{ value.img }}"></a>
          {{value.name}} by {{ value.artist }}
          <form method="post" action="{% url 'save_track' %}">
            {% csrf_token %}
            <input type="hidden" name="title" value="{{ value.name }}">
            <input type="hidden" name="artist" value="{{ value.artist }}">
            <input type="hidden" name="img" value="{{ value.img }}">
            <input type="hidden" name="url" value="{{ value.url }}">
            <button type="submit">Save To Playlist</button>
          </form>
        </li>
      {% endfor %}
    </ul>


  {% else %}
    <p>You are not logged in</p>
    <p>Please <a href="{% url 'login' %}">Log In</a> to continue.</p>
  {% endif %}

{% endblock %}